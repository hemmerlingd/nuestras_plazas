window.BMC=function(a,b,c){var d={};return d.cache=function(){d.$els={$document:c(b),$BMC:c('#bmc')},d.$els.$sidebar=d.$els.$BMC.find('.c-sidebar'),d.$els.$hamburger=d.$els.$BMC.find('.c-hamburger'),d.$els.$dropdownLinks=d.$els.$sidebar.find('.c-dropdown a'),d.$els.$listaActividades=d.$els.$BMC.find('.c-buscador__contenido'),d.$els.$actividades=d.$els.$listaActividades.find('.o-actividad'),d.$els.$particular=d.$els.$BMC.find('.c-actividades--particular'),d.$els.$loader=d.$els.$BMC.find('.c-loading'),d.$els.$mensaje=d.$els.$BMC.find('.c-mensaje'),d.$els.$verTodo=d.$els.$BMC.find('#volver-ver-todo'),d.$els.$twitter=d.$els.$particular.find('.c-social__boton--twitter'),d.$els.$facebook=d.$els.$particular.find('.c-social__boton--facebook'),d.$els.$link=d.$els.$particular.find('.c-social__boton--link'),d.$els.$inputLink=d.$els.$particular.find('.c-social__link'),d.url=a.location.protocol+'//'+a.location.hostname+a.location.pathname,d.idAnterior=1,d.urlGoogleCalendar='',d.sinResultados=!1,d.eventos={toggleSidebar:function(){d.$els.$sidebar.toggleClass('c-sidebar--abierto')},toggleDropdown:function(f){f.preventDefault();var g=c(this).parent();g.hasClass('c-sidebar__nav--abierto')?c(this).siblings('.c-dropdown__menu').first().stop(!0,!0).slideUp():c(this).siblings('.c-dropdown__menu').first().stop(!0,!0).slideDown(),g.toggleClass('c-sidebar__nav--abierto')},cerrarSidebarEsc:function(f){27==f.keyCode&&d.$els.$sidebar.removeClass('c-sidebar__nav--abierto')},toggleLoader:function(f){var g=d.$els.$loader;f?g.is(':visible')?g.hide('normal',f):g.fadeIn(d.eventos.ocultarMensaje):g.is(':visible')?g.hide():(d.eventos.ocultarMensaje(),g.fadeIn('normal',f))},ocultarMensaje:function(){d.$els.$mensaje.hide()},volver:function(f){f&&f.preventDefault(),d.eventos.pushState(),d.$els.$mensaje.hide(),d.$els.$particular.hide(),d.$els.$listaActividades.slideDown(),d.sinResultados&&d.$els.$actividades.fadeIn()},mostrarMensaje:function(f){d.eventos.toggleLoader(function(){d.$els.$mensaje.find('p').html('<p>'+f+'</p>').parent().fadeIn()})},mostrarTodasActividades:function(f){f.preventDefault(),d.$els.$particular.hide(),d.$els.$listaActividades.show(),d.$els.$mensaje.hide(),d.$els.$loader.hide(),d.$els.$actividades.fadeIn(),d.$els.$verTodo.hide()}},d.eventos.cambiarDatosEventoParticular=function(f){var g=d.$els.$particular;if('No encontrado.'===f.detail)d.eventos.mostrarMensaje('Disculpe, no se encontr\xF3 el evento. Puede que ya haya terminado.');else if(void 0===f.id||!1===f.success||1>f.id)d.eventos.mostrarMensaje('Ocurri\xF3 un error al cargar el evento, pod\xE9s <a href="#" id="reintentar">intentar de nuevo</a> o buscar otra actividad.');else{g.find('.o-actividad--particular').attr('data-id',f.id),g.find('.o-actividad__titulo').html(f.titulo),f.descripcion?g.find('.o-actividad__descripcion').html(f.descripcion):g.find('.o-actividad__descripcion').html('');let l=''!=f.imagen&&f.imagen.original;if(l||(l=''==f.flyer?buscarActividad.imagen:f.flyer.original),g.find('img').attr('src',l),f.agrupador?g.find('.o-actividad__evento').html('<b>'+f.agrupador.nombre+'<b>').show():g.find('.o-actividad__evento').html('').hide(),f.fecha_actividad?g.find('.o-actividad__fecha-actividad').html(f.fecha_actividad):g.find('.o-actividad__fecha-actividad').html(''),f.fecha_inicia?g.find('.o-actividad__fecha-inicia').html('<b>Inicia:</b> '+f.fecha_inicia).show():g.find('.o-actividad__fecha-inicia').html('').hide(),f.fecha_termina?g.find('.o-actividad__fecha-termina').html('<b>Termina:</b> '+f.fecha_termina).show():g.find('.o-actividad__fecha-termina').html('').hide(),g.find('input').val('').hide(),g.find('.o-actividad__boton-calendario').attr('href',d.urlGoogleCalendar),f.tipos){var h=f.tipos,j='';for(var k in h)j+='<span class="c-tipos__tipo">'+h[k].nombre+'</span>';g.find('.c-tipos').html(j).show()}else g.find('.c-tipos').html('').hide();f.lugar?g.find('.o-actividad__lugar').html('<b>Lugar:</b> '+f.lugar.nombre).show():g.find('.o-actividad__lugar').html('').hide();let m=!1;if(0<f.precios.length)if(1==f.precios.length&&'Todos'==f.precios[0].grupo.nombre&&'0.00'==f.precios[0].valor)m='<p class="o-actividad__precio .o-actividad__precio--gratis">Gratis</p>';else{m='';for(let n=0;n<f.precios.length;n++)m+='<p class="o-actividad__precio"><b>'+f.precios[n].grupo.nombre+':</b> $ '+f.precios[n].valor+(f.precios[n].detalles?' - '+f.precios[n].detalles:'')+'</p>'}m?(g.find('.--precios').show(),g.find('.o-actividad--particular__precios').html(m)):(g.find('.o-actividad--particular__precios').html(''),g.find('.--precios').hide()),d.idAnterior=f.id,d.eventos.toggleLoader(function(){g.fadeIn()})}},d.eventos.buscarResultadoAjax=function(f){d.eventos.toggleLoader(),c.ajax({type:'POST',dataType:'JSON',url:buscarActividad.url,data:f,success:function(g){g.data?d.eventos.cambiarDatosEventoParticular(g.data):(alert('Sin respuesta'),c('#BMC .c-atras').click(),d.eventos.pushState())},error:function(){c('#BMC .c-atras').click(),d.eventos.pushState()}})},d.eventos.buscarResultado=function(f){var g=f.attr('data-id'),h={action:'buscar_actividad',nonce:buscarActividad.nonce,id:g};d.eventos.buscarResultadoAjax(h)},d.eventos.pushState=function(f=''){a.history.pushState(null,null,d.url+f)},d.eventos.clickEnActividad=function(f){d.$els.$listaActividades.hide();const g=c(f.target).parents('li').attr('data-id');g==d.idAnterior?(d.eventos.pushState('?ac='+d.idAnterior),d.$els.$particular.fadeIn()):(d.eventos.buscarResultado(c(f.target).parents('li')),d.urlGoogleCalendar=c(f.target).parents('li').find('.o-actividad__boton-calendario').attr('href'),d.eventos.pushState('?ac='+g))},d.eventos.compartirFacebook=function(f){f.preventDefault();var g=c(f.target).parents('.o-actividad').attr('data-id');return a.open('https://www.facebook.com/sharer/sharer.php?u='+d.url+'?ac='+g,'pop','width=600, height=400, \'menubar=0,location=0,toolbar=0,status=0,scrollbars=1\''),!1},d.eventos.compartirTwitter=function(f){f.preventDefault();var g=c(f.target).parents('.o-actividad');return a.open('http://twitter.com/home?status='+g.find('.o-actividad__titulo').text()+' '+d.url+'?ac='+g.attr('data-id'),'pop','width=600, height=300, \'menubar=0,location=0,toolbar=0,status=0,scrollbars=1\''),!1},d.eventos.compartirLink=function(f){f.preventDefault();var g=c(f.target).parents('.o-actividad');return d.$els.$inputLink.val(d.url+'?ac='+g.attr('data-id')).slideDown(),!1},d.eventos.filtrar=function(f){d.eventos.volver(f),d.$els.$loader.hide(),d.$els.$loader.fadeIn();var g=c(this),h=d.$els.$actividades,j=h.length,k=[];if(filtro=g.attr('data-filtro'),id=g.attr('data-id'),h.hide(),'tipo'==filtro||'disciplina'==filtro||'audiencia'==filtro||'fecha'==filtro){for(var m,l=0;l<j;l++)m=h.eq(l).attr('data-'+filtro).split('|'),m.pop(),0<=c.inArray(id,m)&&k.push(h.eq(l));c.each(k,function(n,o){c(o).fadeIn()})}else k=d.$els.$listaActividades.find('li[data-'+filtro+'="'+id+'"]').fadeIn();1>k.length?(d.sinResultados=!0,d.$els.$listaActividades.hide(),d.eventos.mostrarMensaje('No se encontraron resultados. <a id="ver-todo" href="#">Ver todas las actividades</a>')):(d.sinResultados=!1,d.eventos.toggleLoader(),d.$els.$verTodo.show()),d.eventos.toggleSidebar()}},d.init=function(){d.cache(),c('#bmc .c-atras').click(d.eventos.volver),c('#bmc .c-sidebar__toggle').on('click',d.eventos.toggleSidebar),d.$els.$hamburger.on('click',d.eventos.toggleSidebar),d.$els.$dropdownLinks.on('click',d.eventos.toggleDropdown),d.$els.$document.keyup(d.eventos.cerrarSidebarEsc),d.$els.$document.on('click','.c-buscador__contenido .o-actividad .o-actividad__contenedor-link',d.eventos.clickEnActividad),d.$els.$document.on('click','#reintentar',function(f){f.preventDefault(),d.eventos.buscarResultadoAjax({action:'buscar_actividad',nonce:buscarActividad.nonce,id:d.idAnterior})}),d.$els.$facebook.click(d.eventos.compartirFacebook),d.$els.$twitter.click(d.eventos.compartirTwitter),d.$els.$link.click(d.eventos.compartirLink),d.$els.$document.on('click','.c-dropdown__item',d.eventos.filtrar),d.$els.$document.on('click','.c-boton_fecha--semana',d.eventos.filtrar),d.$els.$document.on('click','.c-boton_fecha--mes',d.eventos.filtrar),d.$els.$document.on('click','.c-boton_fecha--ninguno',function(f){d.eventos.mostrarTodasActividades(f),d.eventos.toggleSidebar(f)}),d.$els.$document.on('click','#ver-todo',d.eventos.mostrarTodasActividades),d.$els.$document.on('click','#volver-ver-todo',d.eventos.mostrarTodasActividades),void 0!==buscarActividad.actividad&&(d.$els.$listaActividades.hide(),d.eventos.buscarResultadoAjax({action:'buscar_actividad',nonce:buscarActividad.nonce,id:buscarActividad.actividad})),a.addEventListener('popstate',function(f){f.preventDefault(),d.$els.$particular.is(':visible')&&!d.$els.$loader.is(':visible')?d.eventos.volver():!d.$els.$loader.is(':visible')&&a.history.back()},!1)},c(b).ready(d.init),d}(window,document,jQuery);